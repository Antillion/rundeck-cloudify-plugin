box: python:2.7-onbuild
build:
  steps:
    - script:
        name: Install required libs
        code: |
            pip install tox
            pip install codecov
    - script:
        name: Run Tox
        code: |
            tox
    - script:
        name: Install Cfy
        code: |
          pip install cloudify==3.4.0
    - script:
        name: Validate local install blueprint
        code: |
          cd examples
          export HOSTNAME=test
          export API_KEY=test
          cfy local init --install-plugins -p simple-example.blueprint.yaml -i "hostname=${HOSTNAME};api_key=${API_KEY}"
          cfy local install -w simple-example.blueprint.yaml -i "hostname=${HOSTNAME};api_key=${API_KEY}"
    - script:
        name: Upload codecov results
        code: codecov --token=$CODECOV
